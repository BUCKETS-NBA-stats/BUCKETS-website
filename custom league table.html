<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Regular Season BUCKETS: Custom table</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<title>Regular Season BUCKETS: Custom table</title>
		
		<script src="assets/js/jquery.min.js"></script>
 	   
    	<!-- DataTables CSS -->
		<link rel="stylesheet" href="https://cdn.datatables.net/v/dt/dt-2.1.8/date-1.5.4/fh-4.0.1/sb-1.8.1/datatables.min.css">

		<!-- DataTables JS -->
		<script src="https://cdn.datatables.net/v/dt/dt-2.1.8/date-1.5.4/fh-4.0.1/sb-1.8.1/datatables.min.js"></script>

		<!-- Papa Parse CSV parser -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

		<style>
			/* Table styling */
			#league-summary {
				width: 100%;
				table-layout: fixed;
				overflow: hidden;
			}
			/* Column selector */
			/* Reset styles for .column-selector and checkboxes */
			.column-selector * {
			    all: unset;           /* Remove all inherited styles */
			    display: inline-block; /* Ensure items align horizontally */
			}

			.column-selector input[type="checkbox"] {
			    all: unset;
			    -webkit-appearance: checkbox;
			    -moz-appearance: checkbox;
			    appearance: checkbox;
				width: 20px;
    			height: 20px;
    			margin-right: 5px;
    			display: inline-block;
			}

			.column-selector {
    			margin-bottom: 15px;
    			display: flex;
    			flex-wrap: wrap;
			}

			.column-selector label {
    			margin-right: 10px;
    			margin-bottom: 5px;
			}

		</style>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
									<a href="index.html" class="logo"><strong>BUCKETS</strong> NBA Stats</a>
									<ul class="icons">
										<li><a href="twitter.com" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
										<li><a href="mailto:BUCKETS.stat@gmail.com" class="icon solid fa-envelope"><span class="label">Email</span></a></li>
									</ul>
								</header>

							<!-- Table -->
								<body>
									<h2>Regular Season BUCKETS: Custom table builder</h1>
								
									<!-- Column selector -->
									<div class="column-selector">
										<label><input type="checkbox" class="column-toggle" data-column="0" checked> Player</label>
										<label><input type="checkbox" class="column-toggle" data-column="1" checked> Year</label>
										<!-- <label><input type="checkbox" class="column-toggle" data-column="2" checked> Player Year</label> -->
										<label><input type="checkbox" class="column-toggle" data-column="3" checked> G</label>
										<label><input type="checkbox" class="column-toggle" data-column="4" checked> Total Plays</label>
										
										<label><input type="checkbox" class="column-toggle" data-column="5" checked> On-ball PRF/g</label>
										<!-- <label><input type="checkbox" class="column-toggle" data-column="6" checked> On-ball PRF baseline</label> -->
										<label><input type="checkbox" class="column-toggle" data-column="7" checked> On-ball Plays/g</label>
										<label><input type="checkbox" class="column-toggle" data-column="8" checked> On-ball rORTG</label>
										<label><input type="checkbox" class="column-toggle" data-column="9" checked> On-ball PC/g</label>
										
										<label><input type="checkbox" class="column-toggle" data-column="10" checked> Off-ball: Partner PRF/g</label>
										<!-- <label><input type="checkbox" class="column-toggle" data-column="11" checked> Off-ball: Partner PRF/g baseline</label> -->
										<label><input type="checkbox" class="column-toggle" data-column="12" checked> Off-ball: Partner Plays/g</label>
										<label><input type="checkbox" class="column-toggle" data-column="13" checked> Off-ball: Partner rORTG</label>
										<label><input type="checkbox" class="column-toggle" data-column="14" checked> Off-ball: Partner PC/g</label>
									
										<label><input type="checkbox" class="column-toggle" data-column="15" checked> Off-ball: Space PRF/g</label>
										<!-- <label><input type="checkbox" class="column-toggle" data-column="16" checked> Off-ball: Space PRF/g baseline</label> -->
										<label><input type="checkbox" class="column-toggle" data-column="17" checked> Off-ball: Space Plays/g</label>
										<label><input type="checkbox" class="column-toggle" data-column="18" checked> Off-ball: Space rORTG</label>
										<label><input type="checkbox" class="column-toggle" data-column="19" checked> Off-ball: Space PC/g</label>
									
										<label><input type="checkbox" class="column-toggle" data-column="20" checked> Off-ball: Crash PRF/g</label>
										<!-- <label><input type="checkbox" class="column-toggle" data-column="21" checked> Off-ball: Crash PRF/g baseline</label> -->
										<label><input type="checkbox" class="column-toggle" data-column="22" checked> Off-ball: Crash Plays/g</label>
										<label><input type="checkbox" class="column-toggle" data-column="23" checked> Off-ball: Crash rORTG</label>
										<label><input type="checkbox" class="column-toggle" data-column="24" checked> Off-ball: Crash PC/g</label>
									
										<label><input type="checkbox" class="column-toggle" data-column="25" checked> Transition PRF/g</label>
										<!-- <label><input type="checkbox" class="column-toggle" data-column="26" checked> Transition PRF/g baseline</label> -->
										<label><input type="checkbox" class="column-toggle" data-column="27" checked> Transition Plays/g</label>
										<label><input type="checkbox" class="column-toggle" data-column="28" checked> Transition rORTG</label>
										<label><input type="checkbox" class="column-toggle" data-column="29" checked> Transition PC/g</label>
									
										<label><input type="checkbox" class="column-toggle" data-column="30" checked> Total PRF/g</label>
										<!-- <label><input type="checkbox" class="column-toggle" data-column="31" checked> Total PRF/g baseline</label> -->
										<label><input type="checkbox" class="column-toggle" data-column="32" checked> Total Plays/g</label>
										<label><input type="checkbox" class="column-toggle" data-column="33" checked> Total rORTG</label>
										<label><input type="checkbox" class="column-toggle" data-column="34" checked> Total PC/g</label>
									</div>
									
									<!-- Table for DataTables -->
									<table id="league-summary" class="display compact">
										<thead>
											<tr>
												<th>Player</th>
												<th>Year</th>
												<th>Player Year</th>
												<th>Games</th>
												<th title="Total plays with a scoring attempt, playmaking attempt, or turnover">Total plays</th>
												<th title="Points Responsible For: &#10;Total scored and assisted points including FT">On-ball PRF/g</th>
												<th>On-ball PRF baseline</th>
												<th title="Total plays per game with a scoring attempt, playmaking attempt, or turnover">On-ball Plays/g</th>
												<th title="Relative Offensive Rating: &#10;Points per 100 plays above baseline. &#10;For on-ball, baseline is league average half court offensive rating">On-ball rORTG</th>
												<th title="Points Created: &#10;Total points added vs baseline efficiency">On-ball PC/g</th>
												<th title="Points Responsible For: &#10;Total points scored including FT">Off-ball: Partner PRF/g</th>
												<th>Off-ball: Partner PRF/g baseline</th>
												<th title="Total plays per game with a scoring attempt or turnover">Off-ball: Partner Plays/g</th>
												<th title="Relative Offensive Rating: &#10;Points per 100 plays above baseline. &#10;For off-ball, baseline is average PPP for the play type">Off-ball: Partner rORTG</th>
												<th title="Points Created: &#10;Total points added vs baseline efficiency">Off-ball: Partner PC/g</th>
												<th title="Points Responsible For: &#10;Total points scored including FT">Off-ball: Space PRF/g</th>
												<th>Off-ball: Space PRF/g baseline</th>
												<th title="Total plays per game with a scoring attempt or turnover">Off-ball: Space Plays/g</th>
												<th title="Relative Offensive Rating: &#10;Points per 100 plays above baseline. &#10;For off-ball, baseline is average PPP for the play type">Off-ball: Space rORTG</th>
												<th title="Points Created: &#10;Total points added vs baseline efficiency">Off-ball: Space PC/g</th>
												<th title="Points Responsible For: &#10;Total points scored including FT">Off-ball: Crash PRF/g</th>
												<th>Off-ball: Crash PRF/g baseline</th>
												<th title="Total plays per game with a scoring attempt or turnover">Off-ball: Crash Plays/g</th>
												<th title="Relative Offensive Rating: &#10;Points per 100 plays above baseline. &#10;For off-ball, baseline is average PPP for the play type">Off-ball: Crash rORTG</th>
												<th title="Points Created: &#10;Total points added vs baseline efficiency">Off-ball: Crash PC/g</th>
												<th title="Points Responsible For: &#10;Total scored and assisted points including FT">Transition PRF/g</th>
												<th>Transition PRF/g baseline</th>
												<th title="Total plays per game with a scoring attempt, playmaking attempt, or turnover">Transition Plays/g</th>
												<th title="Relative Offensive Rating: &#10;Points per 100 plays above baseline. &#10;For transition, baseline is league average half court offensive rating">Transition rORTG</th>
												<th title="Points Created: &#10;Total points added vs baseline efficiency">Transition PC/g</th>
												<th title="Points Responsible For: &#10;Total scored and assisted points including FT">Total PRF/g</th>
												<th>Total PRF/g baseline</th>
												<th title="Total plays per game with a scoring attempt, playmaking attempt, or turnover">Total Plays/g</th>
												<th title="Relative Offensive Rating: &#10;Points per 100 plays above baseline">Total rORTG</th>
												<th title="Points Created: &#10;Total points added vs baseline efficiency">Total PC/g</th>
											</tr>
										</thead>
										<tbody>
											<!-- Data from CSV will be loaded here -->
										</tbody>
									</table>
									<script>
										var table;
									
										$(document).ready(function() {
											console.log("Document ready - initializing DataTable...");
									
											// Initialize the DataTable without data for now
											table = $('#league-summary').DataTable({
												columns: [
													{ title: "Player", data: "Player", visible: true },
													{ title: "Year", data: "Year", visible: true },
													{ title: "Player Year", data: "Player Year", visible: false },
													{ title: "G", data: "Games", visible: true, visible: false },
													{ title: "Total Plays", data: "Total plays", visible: false },
													{ title: "On-ball PRF/g", data: "On-ball PRF/g", visible: false },
													{ title: "On-ball PRF baseline", data: "On-ball PRF baseline", visible: false },
													{ title: "On-ball Plays/g", data: "On-ball Plays/g", visible: false },
													{ title: "On-ball rORTG", data: "On-ball rORTG", visible: false },
													{ title: "On-ball PC/g", data: "On-ball PC/g", visible: false },
													{ title: "Off-ball: Partner PRF/g", data: "Off-ball: Partner PRF/g", visible: false },
													{ title: "Off-ball: Partner PRF/g baseline", data: "Off-ball: Partner PRF/g baseline", visible: false },
													{ title: "Off-ball: Partner Plays/g", data: "Off-ball: Partner Plays/g", visible: false },
													{ title: "Off-ball: Partner rORTG", data: "Off-ball: Partner rORTG", visible: false },
													{ title: "Off-ball: Partner PC/g", data: "Off-ball: Partner PC/g", visible: false },
													{ title: "Off-ball: Space PRF/g", data: "Off-ball: Space PRF/g", visible: false },
													{ title: "Off-ball: Space PRF/g baseline", data: "Off-ball: Space PRF/g baseline", visible: false },
													{ title: "Off-ball: Space Plays/g", data: "Off-ball: Space Plays/g", visible: false },
													{ title: "Off-ball: Space rORTG", data: "Off-ball: Space rORTG", visible: false },
													{ title: "Off-ball: Space PC/g", data: "Off-ball: Space PC/g", visible: false },
													{ title: "Off-ball: Crash PRF/g", data: "Off-ball: Crash PRF/g", visible: false },
													{ title: "Off-ball: Crash PRF/g baseline", data: "Off-ball: Crash PRF/g baseline", visible: false },
													{ title: "Off-ball: Crash Plays/g", data: "Off-ball: Crash Plays/g", visible: false },
													{ title: "Off-ball: Crash rORTG", data: "Off-ball: Crash rORTG", visible: false },
													{ title: "Off-ball: Crash PC/g", data: "Off-ball: Crash PC/g", visible: false },
													{ title: "Transition PRF/g", data: "Transition PRF/g", visible: false },
													{ title: "Transition PRF/g baseline", data: "Transition PRF/g baseline", visible: false },
													{ title: "Transition Plays/g", data: "Transition Plays/g", visible: false },
													{ title: "Transition rORTG", data: "Transition rORTG", visible: false },
													{ title: "Transition PC/g", data: "Transition PC/g", visible: false },
													{ title: "Total PRF/g", data: "Total PRF/g", visible: true },
													{ title: "Total PRF/g baseline", data: "Total PRF/g baseline", visible: false },
													{ title: "Total Plays/g", data: "Total Plays/g", visible: true },
													{ title: "Total rORTG", data: "Total rORTG", visible: true },
													{ title: "Total PC/g", data: "Total PC/g", visible: true }
												],
												autoWidth: false,
												retrieve: true,
												responsive: true,
												fixedHeader: true,
												pageLength: 25,
												lengthMenu: [ [10, 25, 50, 100], [10, 25, 50, 100] ],
												dom: 'Qrtip',
												searchBuilder: {
													columns: function() {
														return table.columns().indexes().filter(function(index) {
															return table.column(index).visible();
														}).toArray();
													}
												},
											});
									
											// Load CSV file using Papa Parse
											Papa.parse('assets/data/league-table.csv', {
												download: true,
												header: true,
												skipEmptyLines: true,
												complete: function(results) {
													console.log("Parsing Complete:", results);
									
													// Prepare data for DataTable by mapping each row to the correct columns
													const formattedData = results.data.map(row => ({
														"Player": row["Player"],
														"Year": row["Year"],
														"Player Year": row["Player Year"],
														"Games": row["Games"],
														"Total plays": row["Total plays"],
														"On-ball PRF/g": row["On-ball PRF/g"],
														"On-ball PRF baseline": row["On-ball PRF baseline"],
														"On-ball Plays/g": row["On-ball Plays/g"],
														"On-ball rORTG": row["On-ball rORTG"],
														"On-ball PC/g": row["On-ball PC/g"],
														"Off-ball: Partner PRF/g": row["Off-ball: Partner PRF/g"],
														"Off-ball: Partner PRF/g baseline": row["Off-ball: Partner PRF/g baseline"],
														"Off-ball: Partner Plays/g": row["Off-ball: Partner Plays/g"],
														"Off-ball: Partner rORTG": row["Off-ball: Partner rORTG"],
														"Off-ball: Partner PC/g": row["Off-ball: Partner PC/g"],
														"Off-ball: Space PRF/g": row["Off-ball: Space PRF/g"],
														"Off-ball: Space PRF/g baseline": row["Off-ball: Space PRF/g baseline"],
														"Off-ball: Space Plays/g": row["Off-ball: Space Plays/g"],
														"Off-ball: Space rORTG": row["Off-ball: Space rORTG"],
														"Off-ball: Space PC/g": row["Off-ball: Space PC/g"],
														"Off-ball: Crash PRF/g": row["Off-ball: Crash PRF/g"],
														"Off-ball: Crash PRF/g baseline": row["Off-ball: Crash PRF/g baseline"],
														"Off-ball: Crash Plays/g": row["Off-ball: Crash Plays/g"],
														"Off-ball: Crash rORTG": row["Off-ball: Crash rORTG"],
														"Off-ball: Crash PC/g": row["Off-ball: Crash PC/g"],
														"Transition PRF/g": row["Transition PRF/g"],
														"Transition PRF/g baseline": row["Transition PRF/g baseline"],
														"Transition Plays/g": row["Transition Plays/g"],
														"Transition rORTG": row["Transition rORTG"],
														"Transition PC/g": row["Transition PC/g"],
														"Total PRF/g": row["Total PRF/g"],
														"Total PRF/g baseline": row["Total PRF/g baseline"],
														"Total Plays/g": row["Total Plays/g"],
														"Total rORTG": row["Total rORTG"],
														"Total PC/g": row["Total PC/g"]
													}));
									
													// Add all rows to the table and redraw
													table.rows.add(formattedData).draw();
													table.order([34, 'desc']).draw();
												},
												error: function(error) {
													console.error("Error loading CSV file:", error);
												}
											});

											// Ensure checkboxes match initial column visibility state
    										$('.column-toggle').each(function() {
        										var column = table.column($(this).data('column'));
        										$(this).prop('checked', column.visible());
    										});

											// Toggle column visibility based on checkbox selection
											$('.column-toggle').on('change', function() {
												var column = table.column($(this).data('column'));
												column.visible($(this).is(':checked'));
											});
																												
											// Filter: Min Plays Logic
											$.fn.dataTable.ext.search.push(function(settings, data, dataIndex) {
												var totalPlays = parseFloat(data[4]) || 0; // Assuming column index 4 for "Total plays"
												return totalPlays >= 150;
											});
									
											// Filter: Custom Exclusion Logic
											$.fn.dataTable.ext.search.push(function(settings, data, dataIndex) {
												var spacePRF = parseFloat(data[15]) || 0; // Column index 15 for "Space PRF"
												var spacePRFplays = parseFloat(data[17]) || 0; // Column index 17 for "Space PRF baseline"
												return !(spacePRFplays === 0 && spacePRF > 0);
											});
										});
									</script>
									
								</body>
						</div>
					</div>

				<!-- Sidebar -->
				<div id="sidebar">
					<div class="inner">

						<!-- Search -->
							 <!-- not sure how to get Search to work
								<section id="search" class="alt">
									<form method="post" action="#">
										<input type="text" name="query" id="query" placeholder="Search" />
									</form>
								</section>
							-->

						<!-- Menu -->
							<nav id="menu">
								<header class="major">
									<h2>Menu</h2>
								</header>
								<ul>
									<li><a href="index.html">Homepage</a></li>
									<li>
										<span class="opener">Stats</span>
										<ul>
											<li><a href="league table.html">League-wide: Regular season</a></li>
											<li><a href="team summary.html">Team Summary</a></li>
											<li><a href="player season.html">Player-season Snapshot</a></li>
											<li><a href="player career.html">Career Overview</a></li>
											<li><a href="#">More coming soon</a></li>
										</ul>
									</li>
									<li>
										<span class="opener">Insights</span>
										<ul>
											<li><a href="floor raising.html">The Westbrook Theorem</a></li>
											<li><a href="#">More coming soon</a></li>
										</ul>
									</li>
									<li><a href="methodology.html">Under the hood</a></li>
								</ul>
							</nav>
						
						<!-- Section -->
							<section>
								<header class="major">
									<h2>Get in touch</h2>
								</header>
								<ul class="contact">
									<li class="icon solid fa-envelope"><a href="mailto:BUCKETS.stat@gmail.com">BUCKETS.stat@gmail.com</a></li>
									<li class="icon brands fa-twitter"><a href="twitter.com">Twitter.com</a></li>
								</ul>
							</section>

						<!-- Footer -->
							<footer id="footer">
								<p class="copyright">&copy; Untitled. All rights reserved. Demo Images: <a href="https://unsplash.com">Unsplash</a>. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
							</footer>

					</div>
				</div>
			</div>

			<!-- Scripts -->
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>


	</body>
</html>